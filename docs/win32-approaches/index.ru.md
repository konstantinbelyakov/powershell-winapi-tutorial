# Три способа вызвать метод Windows API

Функции Windows API хорошо подходят для низкоуровневых задач, тогда требуется тесное взаимодействие с операционной системой. Есть три способа доступа к Windows API из PowerShell:

1. [Использование коммандлета Add-Type для вызова функции Windows API](add-type.md)
2. [Получение приватного .NET метода вызывающего функцию Windows API](private-method.md)
3. [Вызов функции Windows API из динамически определенного метода](reflection.md)

В большинстве случаев первого способа будет достаточно, способ прост и прямолинеен. Но следует учесть что `Add-Type` вызывает компилятор C# (_css.exe_) и записывает временные файлы на диск, что может быть проблемой в некоторых сценариях. Попробуйте два других способа, если желаете минимизировать след, оставляемый вашим скриптом на целевой системе.

Большинство Windows API функций уже имеют методы-обертки в системном .NET API, но эти методы могут оказаться приватными. Второй способ предполагает нахождение подходящего системного метода и получение доступа к нему.

Третий вариант заключается в использовании отражения (рефлексии) для динамической генерации кода вызова Windows API функции. Этот подход полезен, если требуемая обертка Windows API функции недоступна в .NET сборках, загруженных в текущем сеансе PowerShell, и вы также не хотите оставлять временные файлы на диске.

Следующая ниже таблица может помочь вам выбрать подходящий способ.

|                                        | Коммандлет Add-Type | Приватный метод .NET | Динамически определенный метод |
|----------------------------------------|:-------------------:|:--------------------:|:------------------------------:|
| **Сложность**                          | Низкая              | Средняя              | Высокая                        |
| **Временные файлы**                    | Да                  | Нет                  | Нет                            |
| **Требуется доступная в .NET обертка** | Нет                 | Да                   | Нет                            |
